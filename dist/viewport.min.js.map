{"version":3,"file":"viewport.min.js","sources":["../../function-batcher/src/function-batcher.js","../src/viewport.js"],"sourcesContent":["const add = fns => (...f) => {\n  f.map((fn, index) => dedupe(fns, fn, index))\n  fns.push(...f)\n}\n\nconst dedupe = (fns, fn, index) =>\n  fns.indexOf(fn) !== -1\n    ? delete f[index]\n    : void 0\n\nconst remove = fns => (...f) =>\n  f.map(fn => delete fns[fns.indexOf(fn)])\n\nconst run = fns => (...args) => {\n  fns.map(fn => {\n    if (fn && {}.toString.call(fn) === '[object Function]') {\n      fn(...args)\n    }\n  })\n}\n\nfunction main(...f) {\n  const fns = []\n  add(fns)(...f)\n  return {\n      add: add(fns)\n    , remove: remove(fns)\n    , run: run(fns)\n  }\n}\n\nexport default main\n","import FunctionBatcher from 'function-batcher'\n\nlet timer\nlet started = false\nlet delay = 400\nlet startFns\nlet endFns\nlet visibleFns\nlet hiddenFns\n\nreset()\n\nfunction reset() {\n  startFns = FunctionBatcher()\n  endFns = FunctionBatcher()\n  visibleFns = FunctionBatcher()\n  hiddenFns = FunctionBatcher()\n}\n\nconst onResizeStart = startFns.add\nonResizeStart.remove = startFns.remove\nonResizeStart.reset = () => startFns = FunctionBatcher()\n\nconst onResizeEnd = endFns.add\nonResizeEnd.remove = endFns.remove\nonResizeEnd.reset = () => endFns = FunctionBatcher()\n\nconst onShow = visibleFns.add\nonShow.remove = visibleFns.remove\nonShow.reset = () => visibleFns = FunctionBatcher()\n\nconst onHide = hiddenFns.add\nonHide.remove = hiddenFns.remove\nonHide.reset = () => hiddenFns = FunctionBatcher()\n\nfunction setDelay(duration) {\n  if (/^[0-9][0-9]*$/.test(duration.toString())) {\n    delay = duration\n  }\n}\n\nfunction sizeChange() {\n  if (!started) {\n    startFns.run()\n    started = true\n  }\n  clearTimeout(timer)\n  delay > 0\n    ? timer = setTimeout(runEndFns, delay)\n    : runEndFns()\n}\n\nfunction runEndFns() { \n  endFns.run()\n  started = false\n}\n\nfunction visibilityChange() {\n  document.hidden\n    ? hiddenFns.run()\n    : visibleFns.run()\n}\n\nfunction listen() { \n  document.addEventListener('visibilitychange', visibilityChange)\n  window.addEventListener('resize', sizeChange)\n  window.addEventListener('orientationchange', sizeChange)\n}\n\n// expose stuff for testing\nconst _tests = {\n    delay: () => delay\n  , startFns\n  , endFns\n  , visibleFns\n  , hiddenFns\n}\n\nexport default {\n    onResizeStart\n  , onResizeEnd\n  , onShow\n  , onHide\n  , setDelay\n  , listen\n  , reset\n  , _tests\n}\n"],"names":["add","f","map","fn","index","dedupe","fns","push","indexOf","remove","run","args","toString","call","main","timer","started","delay","startFns","endFns","visibleFns","hiddenFns","reset","FunctionBatcher","onResizeStart","onResizeEnd","onShow","onHide","setDelay","duration","test","sizeChange","setTimeout","runEndFns","visibilityChange","hidden","listen","addEventListener","_tests"],"mappings":"0LAAA,IAAMA,EAAM,SAANA,CAAM,WAAO,UAAU,4BAANC,CAAM,uBAAA,mBACzBC,GAAF,CAAM,SAACC,CAAD,CAAKC,CAAL,SAAeC,EAAOC,CAAP,CAAYH,CAAZ,CAAgBC,CAAhB,CAAf,CAAN,IACIG,IAAJ,SAAYN,CAAZ,EAFU,CAAZ,CAKMI,EAAS,SAATA,CAAS,CAACC,CAAD,CAAMH,CAAN,CAAUC,CAAV,SACbE,EAAIE,OAAJ,CAAYL,CAAZ,IAAoB,EAApB,CACI,OAAOF,EAAEG,CAAF,CADX,CAEI,OAHN,CAKMK,EAAS,SAATA,CAAS,WAAO,sCAAIR,CAAJ,uBAAA,wBACpBA,EAAEC,GAAF,CAAM,mBAAM,OAAOI,EAAIA,EAAIE,OAAJ,CAAYL,CAAZ,CAAJ,CAAb,CAAN,CADoB,CAAP,CAAf,CAGMO,EAAM,SAANA,CAAM,WAAO,UAAa,4BAATC,CAAS,uBAAA,mBAC1BT,GAAJ,CAAQ,WAAM,CACRC,GAAM,GAAGS,QAAH,CAAYC,IAAZ,CAAiBV,CAAjB,IAAyB,mBAAnC,oBACQQ,CAAN,EAFJ,EADU,CAAZ,CAQA,SAASG,CAAT,EAAoB,KACZR,EAAM,EAAZ,GACIA,CAAJ,mCACO,KACEN,EAAIM,CAAJ,CADF,QAEKG,EAAOH,CAAP,CAFL,KAGEI,EAAIJ,CAAJ,EAHT,CCtBF,IAAIS,QAAJ,CACIC,EAAU,EAAd,CACIC,EAAQ,GAAZ,CACIC,QAAJ,CACIC,QAAJ,CACIC,QAAJ,CACIC,QAAJ,CAEAC,IAEA,SAASA,CAAT,EAAiB,GACJC,GAAX,GACSA,GAAT,GACaA,GAAb,GACYA,GAAZ,CAGF,IAAMC,EAAgBN,EAASlB,GAA/B,CACAwB,EAAcf,MAAd,CAAuBS,EAAST,MAAhC,CACAe,EAAcF,KAAd,CAAsB,kBAAMJ,EAAWK,GAAjB,CAAtB,CAEA,IAAME,EAAcN,EAAOnB,GAA3B,CACAyB,EAAYhB,MAAZ,CAAqBU,EAAOV,MAA5B,CACAgB,EAAYH,KAAZ,CAAoB,kBAAMH,EAASI,GAAf,CAApB,CAEA,IAAMG,EAASN,EAAWpB,GAA1B,CACA0B,EAAOjB,MAAP,CAAgBW,EAAWX,MAA3B,CACAiB,EAAOJ,KAAP,CAAe,kBAAMF,EAAaG,GAAnB,CAAf,CAEA,IAAMI,EAASN,EAAUrB,GAAzB,CACA2B,EAAOlB,MAAP,CAAgBY,EAAUZ,MAA1B,CACAkB,EAAOL,KAAP,CAAe,kBAAMD,EAAYE,GAAlB,CAAf,CAEA,SAASK,CAAT,CAAkBC,CAAlB,CAA4B,CACtB,gBAAgBC,IAAhB,CAAqBD,EAASjB,QAAT,EAArB,CAAJ,KACUiB,GAIZ,SAASE,CAAT,EAAsB,CACff,CAAL,KACWN,GAAT,KACU,iBAECK,CAAb,IACQ,CAAR,CACIA,EAAQiB,WAAWC,CAAX,CAAsBhB,CAAtB,CADZ,CAEIgB,GAFJ,CAKF,SAASA,CAAT,EAAqB,GACZvB,GAAP,KACU,GAGZ,SAASwB,CAAT,EAA4B,UACjBC,MAAT,CACId,EAAUX,GAAV,EADJ,CAEIU,EAAWV,GAAX,EAFJ,CAKF,SAAS0B,CAAT,EAAkB,UACPC,gBAAT,CAA0B,kBAA1B,CAA8CH,CAA9C,SACOG,gBAAP,CAAwB,QAAxB,CAAkCN,CAAlC,SACOM,gBAAP,CAAwB,mBAAxB,CAA6CN,CAA7C,EAIF,IAAMO,EAAS,OACJ,oBAAMrB,EADF,WAAA,SAAA,aAAA,aAAf,GAQe,gBAAA,cAAA,SAAA,SAAA,WAAA,SAAA,QAAA,UAAf"}